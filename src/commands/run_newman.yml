description: >
  Runs tests via newman cli

parameters:
  collection:
    type: string
    default: ""
    description: "Postman collection to run"
  environment:
    type: string
    default: ""
    description: "Postman environment to use"
  folder:
    description: Run requests within a particular folder/folders in a collection
    type: string
    default: ''
  reporter:
    type: string
    default: "--reporters cli,testrail"
    description: "Custom reporter to use with newman"

steps:
  - run:
      name: Set TESTRAIL_TITLE in newman
      command: <<include(scripts/setRunName.sh)>>
  - newman/newman-run:
      collection: <<parameters.collection>>
      environment: <<parameters.environment>>
      folder: <<parameters.folder>>
      additional-options: <<parameters.reporter>>
  - store_artifacts:
      path: ~/project/newman
